---
import PlanButton from "./ui/PlanButton.astro";
import checkMark from "../images/icon/check-mark.svg";

const pricingPlans = [
  {
    name: "Free",
    price: "$0",
    description: "Capture ideas and find them quickly",
    selected: false,
    features: [
      "Sync unlimited devices",
      "10 GB monthly uploads",
      "200 MB max. note size",
      "Customize Home dashboard and access extra widgets",
    ],
  },
  {
    name: "Personal",
    price: "$11.99",
    description: "Keep home and family on track",
    selected: true,
    features: [
      "Sync unlimited devices",
      "10 GB monthly uploads",
      "200 MB max. note size",
      "Customize Home dashboard and access extra widgets",
      "Connect primary Google Calendar account",
    ],
  },
  {
    name: "Organization",
    price: "$49.99",
    description: "Capture ideas and find them quickly",
    selected: false,
    features: [
      "Sync unlimited devices",
      "10 GB monthly uploads",
      "200 MB max. note size",
      "Customize Home dashboard and access extra widgets",
      "Connect primary Google Calendar account",
      "Add due dates, reminders, and notifications to your tasks",
    ],
  },
];
---

<div class="w-full bg-white">
  <div
    class="mx-auto flex max-w-[1440px] flex-col gap-[60px] px-[16px] py-[80px] md:gap-[100px] md:px-[32px] md:py-[140px]"
  >
    <div class="text-custom-black flex flex-col gap-[24px] text-center">
      <h2 class="text-[36px] font-bold tracking-[-0.02em] md:text-[72px]">
        Choose Your Plan
      </h2>
      <p class="text-[18px] leading-[30px] tracking-[-0.02em]">
        Whether you want to get organized, keep your personal life on track, or
        boost workplace productivity, Evernote has the right plan for you.
      </p>
    </div>
    <ul class="flex flex-col gap-[32px] md:flex-row">
      {
        pricingPlans.map((plan) => (
          <li
            class:list={[
              // レイアウト・ポジショニング
              "group relative flex cursor-pointer flex-col items-start justify-between gap-[24px]",
              // 外観・装飾
              "rounded-[10px] bg-white px-[44px] py-[40px]",
              // 疑似要素(before)のベーススタイル
              "before:border-secondary before:absolute before:inset-0 before:rounded-[10px] before:border-4 before:border-solid",
              // 選択状態のシャドウ
              "data-[selected=true]:shadow-[0px_20px_50px_0px_rgba(0,0,0,0.05)]",
              // 選択状態の疑似要素アニメーション
              "data-[selected=true]:before:border-primary data-[selected=true]:before:bg-primary data-[selected=true]:before:scale-y-[1.15] data-[selected=true]:before:transition-transform data-[selected=true]:before:duration-300 data-[selected=true]:before:ease-out",
            ]}
            data-name="plan"
            data-selected={plan.selected ? "true" : undefined}
          >
            <div class="text-custom-black relative flex flex-col gap-[24px] group-data-[selected=true]:text-white">
              <h3 class="text-[24px] leading-[36px] font-semibold">
                {plan.name}
              </h3>
              <p class="group-data-[selected=true]:text-secondary text-[36px] font-bold tracking-[-0.72px]">
                {plan.price}
              </p>
              <p class="text-[18px] leading-[23px] font-medium tracking-[-0.36px]">
                {plan.description}
              </p>
              <ul class="flex flex-col gap-[28px] text-[16px] leading-[20px] tracking-[-0.02em]">
                {plan.features.map((feature) => (
                  <li class="flex items-center gap-[19px]">
                    <div
                      class="bg-custom-black group-data-[selected=true]:bg-secondary size-[20px] shrink-0 mask-contain mask-no-repeat"
                      style={`mask-image: url(${checkMark.src})`}
                    />
                    <p>{feature}</p>
                  </li>
                ))}
              </ul>
            </div>
            <PlanButton class="relative">Get Started</PlanButton>
          </li>
        ))
      }
    </ul>
  </div>
</div>

<script>
  // すべてのプランを取得
  const plans = document.querySelectorAll('[data-name="plan"]');

  plans.forEach((plan) => {
    plan.addEventListener("click", () => {
      // すべてのプランからdata-selectedを削除（排他的選択）
      plans.forEach((p) => p.removeAttribute("data-selected"));

      // クリックされたプランにdata-selected="true"を設定
      plan.setAttribute("data-selected", "true");
    });
  });
</script>
